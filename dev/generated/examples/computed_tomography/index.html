<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Computed Tomography · RegularizedLeastSquares.jl</title><meta name="title" content="Computed Tomography · RegularizedLeastSquares.jl"/><meta property="og:title" content="Computed Tomography · RegularizedLeastSquares.jl"/><meta property="twitter:title" content="Computed Tomography · RegularizedLeastSquares.jl"/><meta name="description" content="Documentation for RegularizedLeastSquares.jl."/><meta property="og:description" content="Documentation for RegularizedLeastSquares.jl."/><meta property="twitter:description" content="Documentation for RegularizedLeastSquares.jl."/><meta property="og:url" content="https://github.com/JuliaImageRecon/RegularizedLeastSquares.jl/generated/examples/computed_tomography/"/><meta property="twitter:url" content="https://github.com/JuliaImageRecon/RegularizedLeastSquares.jl/generated/examples/computed_tomography/"/><link rel="canonical" href="https://github.com/JuliaImageRecon/RegularizedLeastSquares.jl/generated/examples/computed_tomography/"/><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../search_index.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../../">RegularizedLeastSquares.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../../">Home</a></li><li><a class="tocitem" href="../getting_started/">Getting Started</a></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox" checked/><label class="tocitem" for="menuitem-3"><span class="docs-label">Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../compressed_sensing/">Compressed Sensing</a></li><li class="is-active"><a class="tocitem" href>Computed Tomography</a><ul class="internal"><li><a class="tocitem" href="#Preparing-the-Inverse-Problem"><span>Preparing the Inverse Problem</span></a></li><li><a class="tocitem" href="#Solving-the-Inverse-Problem"><span>Solving the Inverse Problem</span></a></li></ul></li></ul></li><li><a class="tocitem" href="../../../solvers/">Solvers</a></li><li><a class="tocitem" href="../../explanations/regularization/">Regularization</a></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox"/><label class="tocitem" for="menuitem-6"><span class="docs-label">How to</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../howto/weighting/">Weighting</a></li><li><a class="tocitem" href="../../howto/normal_operator/">Normal Operator</a></li><li><a class="tocitem" href="../../howto/multi_threading/">Multi-Threading</a></li><li><a class="tocitem" href="../../howto/gpu_acceleration/">GPU Acceleration</a></li><li><a class="tocitem" href="../../howto/efficient_kaczmarz/">Efficient Kaczmarz</a></li><li><a class="tocitem" href="../../howto/callbacks/">Callbacks</a></li><li><a class="tocitem" href="../../howto/plug-and-play/">Plug-and-Play Regularization</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-7" type="checkbox"/><label class="tocitem" for="menuitem-7"><span class="docs-label">API Reference</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../API/solvers/">Solvers</a></li><li><a class="tocitem" href="../../../API/regularization/">Regularization Terms</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Computed Tomography</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Computed Tomography</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaImageRecon/RegularizedLeastSquares.jl/blob/master/docs/src/literate/examples/computed_tomography.jl#" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Computed-Tomography-Example"><a class="docs-heading-anchor" href="#Computed-Tomography-Example">Computed Tomography Example</a><a id="Computed-Tomography-Example-1"></a><a class="docs-heading-anchor-permalink" href="#Computed-Tomography-Example" title="Permalink"></a></h1><p>In this example we will go through a simple example from the field of Computed Tomography. In addtion to RegularizedLeastSquares.jl, we will need the packages <a href="https://github.com/JuliaImageRecon/LinearOperatorCollection.jl">LinearOperatorCollection.jl</a>, <a href="https://github.com/JuliaImageRecon/ImagePhantoms.jl">ImagePhantoms.jl</a>, <a href="https://github.com/JuliaImageRecon/ImageGeoms.jl">ImageGeoms.jl</a> and <a href="https://github.com/roflmaostc/RadonKA.jl/tree/main">RadonKA.jl</a>, as well as <a href="https://docs.makie.org/stable/">CairoMakie.jl</a> for visualization. We can install them the same way we did RegularizedLeastSquares.jl.</p><p>RadonKA is a package for the computation of the Radon transform and its adjoint. It is implemented with KernelAbstractions.jl and supports GPU acceleration. See the GPU acceleration <a href="../../howto/gpu_acceleration/">how-to</a> for more information.</p><h2 id="Preparing-the-Inverse-Problem"><a class="docs-heading-anchor" href="#Preparing-the-Inverse-Problem">Preparing the Inverse Problem</a><a id="Preparing-the-Inverse-Problem-1"></a><a class="docs-heading-anchor-permalink" href="#Preparing-the-Inverse-Problem" title="Permalink"></a></h2><p>To get started, let us generate a simple phantom using the ImagePhantoms and ImageGeom packages:</p><pre><code class="language-julia hljs">using ImagePhantoms, ImageGeoms
N = 256
image = shepp_logan(N, SheppLoganToft())
size(image)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(256, 256)</code></pre><p>This produces a 256x256 image of a Shepp-Logan phantom.</p><pre><code class="language-julia hljs">using RadonKA, LinearOperatorCollection
angles = collect(range(0, π, 256))
sinogram = Array(RadonKA.radon(image, angles))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">255×256 Matrix{Float32}:
 0.0      0.0      0.0      0.0      …  0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0      0.0      0.0      0.0         0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0      0.0      0.0      0.0         0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0      0.0      0.0      0.0         0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0      0.0      0.0      0.0         0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0      0.0      0.0      0.0      …  0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0      0.0      0.0      0.0         0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0      0.0      0.0      0.0         0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0      0.0      0.0      0.0         0.0  0.0  0.0  0.0  0.0  0.0  0.0
 2.88889  2.88911  2.88977  2.89086     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 ⋮                                   ⋱       ⋮                        ⋮
 0.0      0.0      0.0      0.0         0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0      0.0      0.0      0.0         0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0      0.0      0.0      0.0         0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0      0.0      0.0      0.0         0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0      0.0      0.0      0.0      …  0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0      0.0      0.0      0.0         0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0      0.0      0.0      0.0         0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0      0.0      0.0      0.0         0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0      0.0      0.0      0.0         0.0  0.0  0.0  0.0  0.0  0.0  0.0</code></pre><p>Afterwards we build a Radon operator implementing both the forward and adjoint Radon transform</p><pre><code class="language-julia hljs">A = RadonOp(eltype(image); angles, shape = size(image));</code></pre><p>To visualize our image we can use CairoMakie:</p><pre><code class="language-julia hljs">using CairoMakie
function plot_image(figPos, img; title = &quot;&quot;, width = 150, height = 150)
  ax = CairoMakie.Axis(figPos[1, 1]; yreversed=true, title, width, height)
  hidedecorations!(ax)
  hm = heatmap!(ax, img)
  Colorbar(figPos[2, 1], hm, vertical = false, flipaxis = false)
end
fig = Figure()
plot_image(fig[1,1], image, title = &quot;Image&quot;)
plot_image(fig[1,2], sinogram, title = &quot;Sinogram&quot;)
plot_image(fig[1,3], backproject(sinogram, angles), title = &quot;Backprojection&quot;)
resize_to_layout!(fig)
fig</code></pre><img src="06bbd149.png" alt="Example block output"/><p>In the figure we can see our original image, the sinogram, and the backprojection of the sinogram. The goal of the inverse problem is to recover the original image from the sinogram.</p><h2 id="Solving-the-Inverse-Problem"><a class="docs-heading-anchor" href="#Solving-the-Inverse-Problem">Solving the Inverse Problem</a><a id="Solving-the-Inverse-Problem-1"></a><a class="docs-heading-anchor-permalink" href="#Solving-the-Inverse-Problem" title="Permalink"></a></h2><p>To recover the image from the measurement vector, we solve the <span>$l^2_2$</span>-regularized least squares problem</p><p class="math-container">\[\begin{equation}
  \underset{\mathbf{x}}{argmin} \frac{1}{2}\vert\vert \mathbf{A}\mathbf{x}-\mathbf{b} \vert\vert_2^2 + \lambda\vert\vert\mathbf{x}\vert\vert^2_2 .
\end{equation}\]</p><p>For this purpose we build a <span>$l^2_2$</span> with regularization parameter <span>$λ=0.001$</span></p><pre><code class="language-julia hljs">using RegularizedLeastSquares
reg = L2Regularization(0.001);</code></pre><p>To solve this inverse problem, the Conjugate Gradient Normal Residual (CGNR) algorithm can be used. This solver is based on the normal operator of the Radon operator and uses both the forward and adjoint Radon transform internally. We now build the corresponding solver</p><pre><code class="language-julia hljs">solver = createLinearSolver(CGNR, A; reg=reg, iterations=20);</code></pre><p>and apply it to our measurement vector</p><pre><code class="language-julia hljs">img_approx = solve!(solver, vec(sinogram))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">65536-element Vector{Float32}:
 0.0
 0.0
 0.0
 0.0
 0.0
 0.0
 0.0
 0.0
 0.0
 0.0
 ⋮
 0.0
 0.0
 0.0
 0.0
 0.0
 0.0
 0.0
 0.0
 0.0</code></pre><p>To visualize the reconstructed image, we need to reshape the result vector to the correct shape. Afterwards we can use CairoMakie again:</p><pre><code class="language-julia hljs">img_approx = reshape(img_approx,size(image));
plot_image(fig[1,4], img_approx, title = &quot;Reconstructed Image&quot;)
resize_to_layout!(fig)
fig</code></pre><img src="97715265.png" alt="Example block output"/><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../compressed_sensing/">« Compressed Sensing</a><a class="docs-footer-nextpage" href="../../../solvers/">Solvers »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.0 on <span class="colophon-date" title="Tuesday 26 November 2024 15:52">Tuesday 26 November 2024</span>. Using Julia version 1.11.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
